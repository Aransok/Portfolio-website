{% extends "portfolio_website/base.html" %}

{% block content %}
<h2>Demo LLM Summarizer</h2>

<form method="POST" id="summarizer-form">
    {% csrf_token %}
    <label for="url">Enter Article URL:</label>
    <input type="text" id="url" name="url" placeholder="Enter URL here...">

    <label for="language">Choose Language:</label>
    <select id="language" name="language">
        <option value="en">English (Default)</option>
        <option value="fr">French</option>
        <option value="es">Spanish</option>
        <option value="de">German</option>
        <option value="ar">Arabic</option>
        <option value="zh-cn">Chinese (Simplified)</option>
        <option value="ru">Russian</option>
    </select>

    <label for="translate">Translate Summary:</label>
    <input type="checkbox" id="translate" name="translate">

    <button type="submit">Summarize</button>
</form>

<h3>Title:</h3>
<p id="title"></p>

<h3>Summary:</h3>
<p id="summary"></p>

<script>
document.getElementById('summarizer-form').addEventListener('submit', async function(event) {
    event.preventDefault(); 

    const formData = new FormData(this); 

    try {
        const response = await fetch("{% url 'demo_llm_summarizer' %}", {
            method: "POST",
            headers: {
                "X-CSRFToken": document.querySelector('[name=csrfmiddlewaretoken]').value  
            },
            body: formData,  
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || "Something went wrong");
        }

        const data = await response.json();
        document.getElementById("title").innerText = data.title;
        document.getElementById("summary").innerText = data.summary;

    } catch (error) {
        console.error("Request failed:", error);
        alert(`Error: ${error.message}`);
    }
});
</script>

{% endblock %}
